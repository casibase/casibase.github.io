"use strict";(self.webpackChunkcasibase_website=self.webpackChunkcasibase_website||[]).push([[3341],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var n=a(7294);function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,s=function(e,t){if(null==e)return{};var a,n,s={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}var i=n.createContext({}),c=function(e){var t=n.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(i.Provider,{value:t},e.children)},u="mdxType",k={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},b=n.forwardRef((function(e,t){var a=e.components,s=e.mdxType,l=e.originalType,i=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),u=c(a),b=s,m=u["".concat(i,".").concat(b)]||u[b]||k[b]||l;return a?n.createElement(m,r(r({ref:t},p),{},{components:a})):n.createElement(m,r({ref:t},p))}));function m(e,t){var a=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var l=a.length,r=new Array(l);r[0]=b;var o={};for(var i in t)hasOwnProperty.call(t,i)&&(o[i]=t[i]);o.originalType=e,o[u]="string"==typeof e?e:s,r[1]=o;for(var c=2;c<l;c++)r[c]=a[c];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}b.displayName="MDXCreateElement"},1323:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>i,contentTitle:()=>r,default:()=>k,frontMatter:()=>l,metadata:()=>o,toc:()=>c});var n=a(7462),s=(a(7294),a(3905));const l={title:"Creating Databases with KubeBlocks",keywords:["Casibase","Private Cloud","Kubernetes","K8s","Application","Database","KubeBlocks","High Availability"],authors:["Flysky-z"]},r=void 0,o={unversionedId:"container-cloud/kubernetes-applications/database",id:"container-cloud/kubernetes-applications/database",title:"Creating Databases with KubeBlocks",description:"Overview",source:"@site/i18n/ja/docusaurus-plugin-content-docs/current/container-cloud/kubernetes-applications/database.md",sourceDirName:"container-cloud/kubernetes-applications",slug:"/container-cloud/kubernetes-applications/database",permalink:"/ja/docs/container-cloud/kubernetes-applications/database",draft:!1,editUrl:"https://github.com/casibase/casibase-website/edit/master/docs/container-cloud/kubernetes-applications/database.md",tags:[],version:"current",frontMatter:{title:"Creating Databases with KubeBlocks",keywords:["Casibase","Private Cloud","Kubernetes","K8s","Application","Database","KubeBlocks","High Availability"],authors:["Flysky-z"]},sidebar:"tutorialSidebar",previous:{title:"Application",permalink:"/ja/docs/container-cloud/kubernetes-applications/overview"},next:{title:"Nodes",permalink:"/ja/docs/category/nodes"}},i={},c=[{value:"Overview",id:"overview",level:2},{value:"Why KubeBlocks?",id:"why-kubeblocks",level:2},{value:"Installing KubeBlocks",id:"installing-kubeblocks",level:2},{value:"Step 1: Deploy Snapshot Controller",id:"step-1-deploy-snapshot-controller",level:3},{value:"Step 2: Get the Latest KubeBlocks Version",id:"step-2-get-the-latest-kubeblocks-version",level:3},{value:"Step 3: Create KubeBlocks CRDs",id:"step-3-create-kubeblocks-crds",level:3},{value:"Step 4: Install KubeBlocks with Helm",id:"step-4-install-kubeblocks-with-helm",level:3},{value:"Creating a Database",id:"creating-a-database",level:2},{value:"Example: Creating a Demo MySQL Cluster",id:"example-creating-a-demo-mysql-cluster",level:3},{value:"More Information",id:"more-information",level:2}],p={toc:c},u="wrapper";function k(e){let{components:t,...a}=e;return(0,s.kt)(u,(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h2",{id:"overview"},"Overview"),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://kubeblocks.io/"},"KubeBlocks")," is an open-source Kubernetes operator and toolset designed to simplify the complexity of running and managing data infrastructure, such as databases, message queues, and streaming systems, on Kubernetes. It provides a declarative approach to deploying and managing stateful applications, allowing you to manage them as easily as stateless ones."),(0,s.kt)("p",null,"This guide will walk you through the process of creating a database cluster using KubeBlocks."),(0,s.kt)("h2",{id:"why-kubeblocks"},"Why KubeBlocks?"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Simplified Management"),": Automates the database lifecycle, including deployment, upgrades, scaling, and monitoring."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Production-Ready"),": Supports high availability, backup and restore, and robust monitoring."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Versatile"),": Supports a wide range of databases, including MySQL, PostgreSQL, MongoDB, Redis, and more.")),(0,s.kt)("h2",{id:"installing-kubeblocks"},"Installing KubeBlocks"),(0,s.kt)("p",null,"You can install KubeBlocks using ",(0,s.kt)("inlineCode",{parentName:"p"},"Helm"),". For more installation options, refer to the ",(0,s.kt)("a",{parentName:"p",href:"https://kubeblocks.io/docs/preview/user_docs/overview/install-kubeblocks"},"KubeBlocks Installation Guide"),"."),(0,s.kt)("p",null,"This guide will use Helm for the installation."),(0,s.kt)("h3",{id:"step-1-deploy-snapshot-controller"},"Step 1: Deploy Snapshot Controller"),(0,s.kt)("p",null,"KubeBlocks requires the Snapshot Controller to manage volume snapshots. First, check if it is already installed in your cluster."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get crd volumesnapshotclasses.snapshot.storage.k8s.io\nkubectl get crd volumesnapshots.snapshot.storage.k8s.io\nkubectl get crd volumesnapshotcontents.snapshot.storage.k8s.io\n")),(0,s.kt)("p",null,"If it is not installed, you can deploy it using the following commands:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"helm repo add piraeus-charts https://piraeus.io/helm-charts/\nhelm repo update\n# Update the namespace to an appropriate value for your environment (e.g. kb-system)\nhelm install snapshot-controller piraeus-charts/snapshot-controller -n kb-system --create-namespace\n")),(0,s.kt)("p",null,"Then, verify the installation:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get pods -n kb-system | grep snapshot-controller\n")),(0,s.kt)("p",null,"The Snapshot Controller should be in the ",(0,s.kt)("inlineCode",{parentName:"p"},"Running")," state."),(0,s.kt)("h3",{id:"step-2-get-the-latest-kubeblocks-version"},"Step 2: Get the Latest KubeBlocks Version"),(0,s.kt)("p",null,"Get the latest stable version tag (e.g. v1.0.1):"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"curl -s \"https://api.github.com/repos/apecloud/kubeblocks/releases?per_page=100&page=1\" | jq -r '.[] | select(.prerelease == false) | .tag_name' | sort -V -r | head -n 1\n\n# Example output:\n# v1.0.1\n")),(0,s.kt)("h3",{id:"step-3-create-kubeblocks-crds"},"Step 3: Create KubeBlocks CRDs"),(0,s.kt)("p",null,"Create the Custom Resource Definitions (CRDs) required by KubeBlocks."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"# Replace <VERSION> with the version you selected\nkubectl create -f https://github.com/apecloud/kubeblocks/releases/download/<VERSION>/kubeblocks_crds.yaml\n\n# Example: If the version is v1.0.1\nkubectl create -f https://github.com/apecloud/kubeblocks/releases/download/v1.0.1/kubeblocks_crds.yaml\n")),(0,s.kt)("h3",{id:"step-4-install-kubeblocks-with-helm"},"Step 4: Install KubeBlocks with Helm"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("strong",{parentName:"p"},"Add the KubeBlocks Helm repository:")),(0,s.kt)("pre",{parentName:"li"},(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"helm repo add kubeblocks https://apecloud.github.io/helm-charts\nhelm repo update\n"))),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("strong",{parentName:"p"},"Install KubeBlocks:"),"\nThis command installs the KubeBlocks chart into the ",(0,s.kt)("inlineCode",{parentName:"p"},"kb-system")," namespace."),(0,s.kt)("pre",{parentName:"li"},(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"helm install kubeblocks kubeblocks/kubeblocks --namespace kb-system --create-namespace\n")))),(0,s.kt)("h2",{id:"creating-a-database"},"Creating a Database"),(0,s.kt)("p",null,"Once KubeBlocks is installed, you can create a database cluster using ",(0,s.kt)("inlineCode",{parentName:"p"},"kubectl"),"."),(0,s.kt)("p",null,"Currently supported databases include:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://kubeblocks.io/docs/preview/kubeblocks-for-mysql/02-quickstart"},"MySQL")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://kubeblocks.io/docs/preview/kubeblocks-for-postgresql/02-quickstart"},"PostgreSQL")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://kubeblocks.io/docs/preview/kubeblocks-for-mongodb/02-quickstart"},"MongoDB")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://kubeblocks.io/docs/preview/kubeblocks-for-redis/02-quickstart"},"Redis")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://kubeblocks.io/docs/preview/kubeblocks-for-kafka/02-quickstart"},"Kafka")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://kubeblocks.io/docs/preview/kubeblocks-for-milvus/02-quickstart"},"Milvus")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://kubeblocks.io/docs/preview/kubeblocks-for-qdrant/02-quickstart"},"Qdrant")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://kubeblocks.io/docs/preview/kubeblocks-for-rabbitmq/02-quickstart"},"RabbitMQ")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://kubeblocks.io/docs/preview/kubeblocks-for-elasticsearch/02-quickstart"},"Elasticsearch"))),(0,s.kt)("h3",{id:"example-creating-a-demo-mysql-cluster"},"Example: Creating a Demo MySQL Cluster"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("strong",{parentName:"p"},"Create a file named ",(0,s.kt)("inlineCode",{parentName:"strong"},"my-mysql-cluster.yaml"),":")),(0,s.kt)("pre",{parentName:"li"},(0,s.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: apps.kubeblocks.io/v1\nkind: Cluster\nmetadata:\n  name: mycluster\n  namespace: demo\nspec:\n  # Deletes all resources when the cluster is deleted\n  terminationPolicy: Delete\n  componentSpecs:\n    - name: mysql\n      # Defines the MySQL component and version\n      componentDef: \"mysql-8.0\" \n      serviceVersion: 8.0.35\n      disableExporter: false\n      # Number of replicas for high availability\n      replicas: 2\n      # Resource allocation for each replica\n      resources:\n        limits:\n          cpu: '0.5'\n          memory: 0.5Gi\n        requests:\n          cpu: '0.5'\n          memory: 0.5Gi\n      # Defines the persistent storage for data\n      volumeClaimTemplates:\n        - name: data\n          spec:\n            storageClassName: \"\"\n            accessModes:\n              - ReadWriteOnce\n            resources:\n              requests:\n                storage: 20Gi\n"))),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("strong",{parentName:"p"},"Apply the manifest to create the cluster:")),(0,s.kt)("pre",{parentName:"li"},(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl apply -f my-mysql-cluster.yaml\n")))),(0,s.kt)("h2",{id:"more-information"},"More Information"),(0,s.kt)("p",null,"For more detailed information, advanced configurations, and troubleshooting with KubeBlocks, please refer to the ",(0,s.kt)("a",{parentName:"p",href:"https://kubeblocks.io"},"official KubeBlocks documentation"),"."))}k.isMDXComponent=!0}}]);