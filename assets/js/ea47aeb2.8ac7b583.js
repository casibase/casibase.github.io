"use strict";(self.webpackChunkcasibase_website=self.webpackChunkcasibase_website||[]).push([[310],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(a),u=o,h=d["".concat(l,".").concat(u)]||d[u]||m[u]||r;return a?n.createElement(h,i(i({ref:t},c),{},{components:a})):n.createElement(h,i({ref:t},c))}));function h(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,i=new Array(r);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:o,i[1]=s;for(var p=2;p<r;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},668:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var n=a(7462),o=(a(7294),a(3905));const r={title:"(Optional) Try with Docker",description:"Try Casibase with Docker",keywords:["Casibase","Docker"],authors:["hsluoyz"]},i=void 0,s={unversionedId:"basic/try-with-docker",id:"basic/try-with-docker",title:"(Optional) Try with Docker",description:"Try Casibase with Docker",source:"@site/docs/basic/try-with-docker.md",sourceDirName:"basic",slug:"/basic/try-with-docker",permalink:"/docs/basic/try-with-docker",draft:!1,editUrl:"https://github.com/casibase/casibase-website/edit/master/docs/basic/try-with-docker.md",tags:[],version:"current",frontMatter:{title:"(Optional) Try with Docker",description:"Try Casibase with Docker",keywords:["Casibase","Docker"],authors:["hsluoyz"]},sidebar:"tutorialSidebar",previous:{title:"Server Installation",permalink:"/docs/basic/server-installation"},next:{title:"(Optional) Try with K8s Helm",permalink:"/docs/basic/try-with-helm"}},l={},p=[{value:"Requirements",id:"requirements",level:2},{value:"Hardware",id:"hardware",level:3},{value:"OS",id:"os",level:3},{value:"Docker",id:"docker",level:3},{value:"Get the image",id:"get-the-image",level:2},{value:"<strong>Option-1</strong>: Use the toy database",id:"option-1-use-the-toy-database",level:3},{value:"<strong>Option-2</strong>: Try with docker-compose",id:"option-2-try-with-docker-compose",level:3},{value:"<strong>Option-3</strong>: Try directly with the standard image",id:"option-3-try-directly-with-the-standard-image",level:3}],c={toc:p},d="wrapper";function m(e){let{components:t,...a}=e;return(0,o.kt)(d,(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"requirements"},"Requirements"),(0,o.kt)("h3",{id:"hardware"},"Hardware"),(0,o.kt)("p",null,"If you want to build the Docker image yourself, please ensure that your machine has at least ",(0,o.kt)("strong",{parentName:"p"},"2GB")," of memory. Casibase's frontend is an NPM project of React. Building the frontend requires at least ",(0,o.kt)("strong",{parentName:"p"},"2GB")," of memory. Having less than ",(0,o.kt)("strong",{parentName:"p"},"2GB")," of memory may result in a frontend build failure."),(0,o.kt)("p",null,"If you only need to run the pre-built image, please ensure that your machine has at least ",(0,o.kt)("strong",{parentName:"p"},"100MB")," of memory."),(0,o.kt)("h3",{id:"os"},"OS"),(0,o.kt)("p",null,"All operating systems (Linux, Windows, and macOS) are supported."),(0,o.kt)("h3",{id:"docker"},"Docker"),(0,o.kt)("p",null,"You can use ",(0,o.kt)("strong",{parentName:"p"},"Docker (docker-engine version >= 17.05)")," in Linux or ",(0,o.kt)("strong",{parentName:"p"},"Docker Desktop")," in Windows and macOS."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://docs.docker.com/get-docker/"},"Docker"))),(0,o.kt)("p",null,"Regardless of the operating system, users must ensure that they have ",(0,o.kt)("strong",{parentName:"p"},"docker-engine version >= 17.05"),". This is because we utilize the multi-stage build feature in the docker-compose.yml, which is supported in versions 17.05 and above. For more information, see ",(0,o.kt)("a",{parentName:"p",href:"https://docs.docker.com/develop/develop-images/multistage-build/"},"https://docs.docker.com/develop/develop-images/multistage-build/"),"."),(0,o.kt)("p",null,"If you use docker-compose, please ensure you have ",(0,o.kt)("strong",{parentName:"p"},"docker-compose version >= 2.2"),". For Linux users, note that docker-compose needs to be installed separately from docker-engine."),(0,o.kt)("h2",{id:"get-the-image"},"Get the image"),(0,o.kt)("p",null,"We have provided two DockerHub images:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Name"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"),(0,o.kt)("th",{parentName:"tr",align:null},"Suggestion"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://hub.docker.com/r/casbin/casibase-all-in-one"},"casibase-all-in-one")),(0,o.kt)("td",{parentName:"tr",align:null},"Both Casibase and a MySQL database are included in the image"),(0,o.kt)("td",{parentName:"tr",align:null},"This image already includes a toy database and is only for testing purposes")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://hub.docker.com/r/casbin/casibase"},"casibase")),(0,o.kt)("td",{parentName:"tr",align:null},"Only Casibase is included in the image"),(0,o.kt)("td",{parentName:"tr",align:null},"This image can be connected to your own database and used in production")))),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"casbin/casibase-all-in-one: This image includes the casibase binary, a MySQL database, and all the necessary configurations. It is designed for new users who want to try Casibase quickly. With this image, you can start Casibase immediately with just one or two commands, without any complex configuration. However, please note that we ",(0,o.kt)("strong",{parentName:"li"},"do not recommend")," using this image in a production environment.")),(0,o.kt)("h3",{id:"option-1-use-the-toy-database"},(0,o.kt)("strong",{parentName:"h3"},"Option-1"),": Use the toy database"),(0,o.kt)("p",null,"Run the container with port ",(0,o.kt)("inlineCode",{parentName:"p"},"14000")," exposed to the host. The image will be automatically pulled if it doesn't exist on the local host."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"docker run -p 14000:14000 casbin/casibase-all-in-one\n")),(0,o.kt)("p",null,"Visit ",(0,o.kt)("a",{parentName:"p",href:"http://localhost:14000"},(0,o.kt)("strong",{parentName:"a"},"http://localhost:14000"))," in your browser. Log into the Casibase dashboard with the default global admin account: ",(0,o.kt)("inlineCode",{parentName:"p"},"built-in/admin")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"admin\n123\n")),(0,o.kt)("h3",{id:"option-2-try-with-docker-compose"},(0,o.kt)("strong",{parentName:"h3"},"Option-2"),": Try with docker-compose"),(0,o.kt)("p",null,"Create a ",(0,o.kt)("inlineCode",{parentName:"p"},"conf/app.conf")," directory in the same directory level as the ",(0,o.kt)("inlineCode",{parentName:"p"},"docker-compose.yml")," file. Then, copy ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/casibase/casibase/blob/master/conf/app.conf"},"app.conf")," from Casibase. For more details about ",(0,o.kt)("inlineCode",{parentName:"p"},"app.conf"),", you can see ",(0,o.kt)("a",{parentName:"p",href:"/docs/basic/server-installation#via-ini-file"},"Via Ini file"),"."),(0,o.kt)("p",null,"Below is a minimal but complete ",(0,o.kt)("inlineCode",{parentName:"p"},"docker-compose.yml")," example that starts a MySQL database and the Casibase service. It configures Casibase to connect to the database using MySQL. Save this file as ",(0,o.kt)("inlineCode",{parentName:"p"},"docker-compose.yml")," (next to a ",(0,o.kt)("inlineCode",{parentName:"p"},"conf")," folder if you want to mount a custom ",(0,o.kt)("inlineCode",{parentName:"p"},"app.conf"),")."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},'services:\n  db:\n    image: mysql:8.0\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: 123456\n      MYSQL_DATABASE: casibase\n    volumes:\n      - db_data:/var/lib/mysql\n    ports:\n      - "3306:3306" # optional: expose DB to host\n\n  casibase:\n    image: casbin/casibase:latest\n    restart: unless-stopped\n    depends_on:\n      - db\n    environment:\n      # Use MySQL driver and point to the db service (service name = host)\n      - driverName=mysql\n      - dataSourceName=root:123456@tcp(db:3306)/\n    ports:\n      - "14000:14000"\n    volumes:\n      # optional: mount your configuration\n      - ./conf/app.conf:/conf/app.conf\n\nvolumes:\n  db_data:\n')),(0,o.kt)("p",null,"What does the above compose file do:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The Casibase container connects to the database using the Compose service name ",(0,o.kt)("inlineCode",{parentName:"li"},"db")," (i.e. ",(0,o.kt)("inlineCode",{parentName:"li"},"db:3306"),"). When both services run in the same Docker network (default for compose), using the service name as host is the simplest and most reliable approach."),(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"dataSourceName")," above uses the MySQL root account for simplicity. For production use please create a dedicated DB user and a strong password."),(0,o.kt)("li",{parentName:"ul"},"Mounting ",(0,o.kt)("inlineCode",{parentName:"li"},"./conf/app.conf")," into ",(0,o.kt)("inlineCode",{parentName:"li"},"/conf/app.conf")," is optional. If you prefer environment variables, you can remove the mount and rely on the ",(0,o.kt)("inlineCode",{parentName:"li"},"driverName")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"dataSourceName")," variables."),(0,o.kt)("li",{parentName:"ul"},"If both ",(0,o.kt)("inlineCode",{parentName:"li"},"app.conf")," and environment variables are provided, the environment variables take precedence and will override the corresponding settings in app.conf.")),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("strong",{parentName:"p"},"Casdoor"),": By default Casibase uses the hosted Casdoor instance at ",(0,o.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com")," for user authentication. If you need to manage users, applications, or customize the authentication flow, you must deploy your own Casdoor instance and update Casibase's ",(0,o.kt)("inlineCode",{parentName:"p"},"app.conf")," (or the equivalent environment variables) to point to your Casdoor server. You can look at ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/docs/basic/server-installation#configure-casdoor"},"Casdoor configuration"))," for more details."),(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"RUNNING_IN_DOCKER")),": By default ",(0,o.kt)("inlineCode",{parentName:"p"},"RUNNING_IN_DOCKER")," is enabled in docker image. When enabled, Casibase replaces ",(0,o.kt)("inlineCode",{parentName:"p"},"localhost")," with the Docker bridge address (for example, ",(0,o.kt)("inlineCode",{parentName:"p"},"host.docker.internal")," or the equivalent bridge hostname) so that the container can reach services running on the host.")),(0,o.kt)("p",null,"Bring up the services:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"docker-compose up -d\n")),(0,o.kt)("p",null,"Check logs (follow):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"docker-compose logs -f casibase\n")),(0,o.kt)("p",null,"Visit ",(0,o.kt)("a",{parentName:"p",href:"http://localhost:14000"},(0,o.kt)("strong",{parentName:"a"},"http://localhost:14000"))," in your browser. Log into the Casibase dashboard with the default global admin account: ",(0,o.kt)("inlineCode",{parentName:"p"},"built-in/admin")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"admin\n123\n")),(0,o.kt)("p",null,"Stop and remove containers and volumes (data removed):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"docker-compose down -v\n")),(0,o.kt)("h3",{id:"option-3-try-directly-with-the-standard-image"},(0,o.kt)("strong",{parentName:"h3"},"Option-3"),": Try directly with the standard image"),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"If it is not convenient to mount the configuration file to a container, using environment variables is also a possible solution."),(0,o.kt)("pre",{parentName:"admonition"},(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="example"',title:'"example"'},"\ndocker run \\\n  -e driverName=mysql \\\n  -e dataSourceName='user:password@tcp(x.x.x.x:3306)/' \\\n  -p 14000:14000 \\\n  casbin/casibase:latest\n\n"))),(0,o.kt)("p",null,"Create ",(0,o.kt)("inlineCode",{parentName:"p"},"conf/app.conf"),". You can copy it from ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/casibase/casibase/blob/master/conf/app.conf"},"conf/app.conf")," in Casibase. For more details about ",(0,o.kt)("inlineCode",{parentName:"p"},"app.conf"),", you can see ",(0,o.kt)("a",{parentName:"p",href:"/docs/basic/server-installation#via-ini-file"},"Via Ini file"),"."),(0,o.kt)("p",null,"Then run"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"docker run  -p 14000:14000 -v /folder/of/app.conf:/conf casbin/casibase:latest\n")),(0,o.kt)("p",null,"Anyway, just ",(0,o.kt)("strong",{parentName:"p"},"mount the app.conf to /conf/app.conf")," and start the container."),(0,o.kt)("p",null,"Visit ",(0,o.kt)("a",{parentName:"p",href:"http://localhost:14000"},(0,o.kt)("strong",{parentName:"a"},"http://localhost:14000"))," in your browser. Log into the Casibase dashboard with the default global admin account: ",(0,o.kt)("inlineCode",{parentName:"p"},"built-in/admin")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"admin\n123\n")))}m.isMDXComponent=!0}}]);